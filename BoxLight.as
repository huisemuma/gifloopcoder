package  {		import flash.display.MovieClip;	import flash.events.Event;	import flash.events.MouseEvent;	import flash.geom.Point;	import flash.geom.PerspectiveProjection;		public class BoxLight extends MovieClip {				private var numPlants:uint = 100;		private var plants:Array = [];		private var pLight:PointLight;		private var pLight0:PointLight;		private var pLight2:PointLight;		private var lightWeight:Number;		private var lightColor:uint;		private var lightChange:Number = 0;				private var lightArr:Array;		private var lightMoveCount:int;				private var point = new PerspectiveProjection();				public function BoxLight() {			init();		}				private function init():void		{			point.projectionCenter = new Point(200,10);			point.fieldOfView = 42;			this.transform.perspectiveProjection = point;						pLight = new PointLight(10, 0xFFFFFF);			pLight.z = -110;						pLight0 = new PointLight(20, 0xFFFFFF);			pLight0.x = 300;			pLight0.y = 250;			pLight0.z = -50;						pLight2 = new PointLight(10, 0x00FF00);			pLight2.x = 50;			pLight2.y = 100;			pLight2.z = -60;						lightArr = [pLight];						for(var i:uint = 0; i < numPlants; i++)			{				var fooX:Plant = new Plant(10, 0xFFFFFF, 0.1);				fooX.x = 100 + 2.5 + 5 * (i % 10);				fooX.y = 150 + 5 + 10 * int(i/10);				fooX.z = -Math.sqrt(3) * 2.5 - 5 * Math.sqrt(3) * (i % 10);				fooX.rotationY = 60;								addChild(fooX);				plants.push(fooX);								var fooY:Plant = new Plant(10, 0xFFFFFF, 0.15);				fooY.x = 150 + 5 + Math.sqrt(3) * 5  * (i % 10);				fooY.y = 150 + 5 + 10 * int(i/10);				fooY.z = 2.5 - 50 * Math.sqrt(3) + 5 * (i % 10);				fooY.rotationY = -30;								addChild(fooY);				plants.push(fooY);								var fooZ:Plant = new Plant(10, 0xFFFFFF, 0.2);				fooZ.x = 100 + 7 + 5 * int(i / 10) + Math.sqrt(3) * 5  * (i % 10);				fooZ.y = 150;				fooZ.z =  - int(i/10) * 5 * Math.sqrt(3) + 5 * (i % 10);				fooZ.rotationX = 90;				fooZ.rotationY = -30;				addChild(fooZ);				plants.push(fooZ);			}						addChild(pLight);						addEventListener(Event.ENTER_FRAME, onEnterframe);			addEventListener(MouseEvent.MOUSE_DOWN, down);			addEventListener(MouseEvent.MOUSE_UP, up);					}				private function down(e:MouseEvent)		{			lightChange = 0.3;		}				private function up(e:MouseEvent)		{			lightChange = -0.3;		}								private function onEnterframe(e:Event):void		{			lightMoveCount += 3;			pLight.x = 200 + Math.cos(lightMoveCount%360/180*Math.PI)*140;			pLight.y = 200 + Math.sin(lightMoveCount%360/180*Math.PI)*100;									var angle:Number;			var powDist:Number;			var dist:Number;			var dx:Number;			var dy:Number;			var dz:Number;			var _lightWeight:Number = pLight.Weight;			trace(pLight.Weight)			for(var i:uint = 0; i < plants.length; i++)			{				plants[i].multiLight(lightArr);			}		}	}	}